# the main training configuration, typically generated from an existing
# preprocessing config file

# seed for initializing the PRNG prior to a training run for reproducible
# results; if unspecified the PRNG chooses its default seeding method
seed: null

# format string for the filename of the final output model; it can use the
# template variables model_name, run_name, and/or run_id, while the required
# variable "checkpoint" will be replaced with names like "best", "last" and
# other intermediate checkpoints
model_filename_format: '{model_name}_{run_name}_{checkpoint}_net.pth'

# format string for the name given to this run for a sequence of runs of the
# same model; the outputs of each run are placed in subdirectories of
# <run_path>/<model_name> with the name of this run; the format string can use
# the template variables model_name and run_id
run_name_format: run_{run_id}

# name and parameters of the neural net model to train
network:
    name: CustomCNN

    # net parameters for CNN
    params: {}

# name and parameters of the optimizer to use; all built-in optimizers from the
# torch.optim package are available for use here, and you can also provide a
# custom optimizer via a plugin
optimizer:
    name: Adam
    params:
        learning_rate: 0.001
        weight_decay: 0
        betas:
        - 0.9
        - 0.999
        eps: 1.0e-08
        amsgrad: false
        maximize: false

# the dataset/simulation configuration
dataset:
    # path to the CSV file containing the per-scenario parameters used in this
    # simulation, either as an absolute path, or as a path relative to this
    # config file
    scenario_params_path: DLModel_preprocessed_params.csv

# list of transforms to apply to the dataset; all optional transforms are
# disabled by default unless specified here; transforms which don't take any
# parameters can be listed just by their name, whereas transforms which do take
# parameters are given as {'name': <name>, 'param1':, 'param2':, ...}, where the
# params map param names (specific to the transform) to their values
dataset_transforms:
-   crop:
        max_snp: 400
        max_indiv: 50
        keep_polymorphic_only: true
-   snp_format: concat
-   validate_snp:
        uniform_shape: false

# number of epochs over which to repeat the training process
n_epochs: 1

# interval (number of batches processed) between two validation steps; for m
# evaluations per epoch, set to n_training_samples // (batch_size * m) where the
# number of training samples can be found in training logs
evaluation_interval: 17

# sample batch size to train on
batch_size: 8

# number of subprocesses to use for data loading
loader_num_workers: 4

# use CUDA-capable GPU where available
use_cuda: true

# specifies the CUDA device index to use
cuda_device: null

# description of the parameters the network will be trained on
learned_params:
-   T00:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false
-   T01:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false
-   T02:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false
-   T03:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false
-   T04:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false
-   T05:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false
-   T06:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false
-   T07:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false
-   T08:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false
-   T09:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false
-   T10:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false
-   T11:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false
-   T12:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false
-   T13:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false
-   T14:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false
-   T15:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false
-   T16:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false
-   T17:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false
-   T18:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false
-   T19:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false
-   T20:
        type: regression
        loss_func: MSE
        loss_weight: 1
        log_transform: false
        tied_to_position: false

# mean of each regression parameter over the training set
train_mean:
    T00: 82459.75301567098
    T01: 82459.75301567098
    T02: 89526.38416613491
    T03: 112705.85129202047
    T04: 127768.77715675776
    T05: 141410.47218635326
    T06: 147621.64886927532
    T07: 158757.06084802333
    T08: 182729.82927008695
    T09: 197125.43125210056
    T10: 211994.22334386522
    T11: 239093.2669429383
    T12: 248280.17606499905
    T13: 250113.9677490789
    T14: 253474.41937209602
    T15: 253474.41937209602
    T16: 253474.41937209602
    T17: 253474.41937209602
    T18: 253474.41937209602
    T19: 253474.41937209602
    T20: 253474.41937209602

# standard deviation of each regression parameter over the training set
train_std:
    T00: 36249.72247986254
    T01: 36249.72247986254
    T02: 77050.539850743
    T03: 152855.51469360918
    T04: 181588.8529281491
    T05: 207752.22418784478
    T06: 214865.43500373623
    T07: 222821.57096440805
    T08: 254704.29438820633
    T09: 271588.2807228761
    T10: 278765.3867294122
    T11: 295508.28704792244
    T12: 295828.8519942915
    T13: 295260.80415708636
    T14: 293794.1421924609
    T15: 293794.1421924609
    T16: 293794.1421924609
    T17: 293794.1421924609
    T18: 293794.1421924609
    T19: 293794.1421924609
    T20: 293794.1421924609
dnadna_version: 1.0.0rc2.dev7+g606bc01
preprocessing_datetime: '2022-06-13T19:32:31.623228+00:00'
inherit: DLModel_preprocessing_config.yml
